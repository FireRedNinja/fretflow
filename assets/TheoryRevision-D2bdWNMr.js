import{r as o,j as e}from"./index-DNOtO4WB.js";import{e as h,C as f}from"./chordUtils-CP8oKaON.js";import"./intervalUtils-bYTG8tbd.js";import"./musicUtils-Bffn_pRB.js";const F=()=>{const[r,d]=o.useState("settings"),[a,j]=o.useState(null),[y,u]=o.useState(""),[v,N]=o.useState(0),[C,S]=o.useState(0),A=["major","minor","diminished","augmented","major7","minor7","dominant7","minor7flat5","diminished7"],[c,k]=o.useState({enabledQualities:A}),[x,T]=o.useState(c),[w,l]=o.useState(""),b=t=>{if(t.length!==0)return t[Math.floor(Math.random()*t.length)]},p=o.useCallback(()=>{if(l(""),c.enabledQualities.length===0){l("Please select at least one chord quality to practice."),d("settings");return}const t=b(c.enabledQualities),s=t?h[t]:void 0;if(!s||!t){l("Failed to select a random chord quality."),d("settings");return}let n;const Q=s.abbr.filter(i=>i!=="");Q.length>0&&(n=b(Q)),n||(n=s.abbr[0]??"?");const m=s.name,z=f.filter(i=>i.name!==m&&c.enabledQualities.includes(Object.keys(h).find(R=>h[R]===i)??"")).sort(()=>.5-Math.random()).slice(0,3).map(i=>i.name),g=new Set([m,...z]);for(;g.size<4&&g.size<f.length;){const i=b(f);i&&i.name!==m&&g.add(i.name)}const I=Array.from(g).sort(()=>.5-Math.random());j({qualityKey:t,symbolToShow:n,correctAnswer:m,answerOptions:I}),u(""),d("question")},[c]),q=t=>{if(r!=="question"||!a)return;S(n=>n+1),t===a.correctAnswer?(u("Correct!"),N(n=>n+1)):u(`Incorrect. "${a.symbolToShow||"(maj)"}" represents "${a.correctAnswer}".`),d("answered")},E=t=>{T(s=>{const n=new Set(s.enabledQualities);return n.has(t)?n.delete(t):n.add(t),{...s,enabledQualities:Array.from(n)}}),l("")},O=()=>{if(x.enabledQualities.length===0){l("Please select at least one chord quality.");return}k(x),N(0),S(0),u(""),j(null),l(""),d("idle")};return o.useEffect(()=>{r==="idle"&&p()},[r,p]),e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-gray-800",children:"Theory Revision: Chord Notation"}),e.jsxs("details",{className:"bg-gray-100 border border-gray-300 rounded-lg mb-6 shadow",open:r==="settings",children:[e.jsx("summary",{className:"p-3 font-semibold cursor-pointer hover:bg-gray-200 rounded-t-lg",children:"Quiz Settings"}),e.jsxs("div",{className:"p-4 border-t border-gray-300 space-y-4",children:[e.jsxs("fieldset",{className:"border border-gray-300 p-3 rounded",children:[e.jsx("legend",{className:"text-md font-medium px-1 text-gray-700",children:"Include Chord Qualities:"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-1 mt-1",children:Object.entries(h).sort(([,t],[,s])=>t.name.localeCompare(s.name)).map(([t,s])=>e.jsxs("label",{className:"flex items-center space-x-1 cursor-pointer",children:[e.jsx("input",{type:"checkbox",value:t,checked:x.enabledQualities.includes(t),onChange:()=>E(t),className:"rounded text-blue-600 focus:ring-blue-500 h-4 w-4"}),e.jsx("span",{className:"text-sm",children:`${s.name} (${s.abbr.join("/")||"maj"})`})]},t))})]}),e.jsxs("div",{className:"pt-3 text-right",children:[w&&e.jsx("p",{className:"text-red-600 text-sm mb-2 text-left",children:w}),e.jsx("button",{onClick:O,className:"py-2 px-5 bg-green-600 text-white rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 transition duration-150 ease-in-out shadow",children:"Apply Settings & Start Quiz"})]})]})]}),r!=="settings"&&a&&e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow mb-6",children:[r==="idle"&&e.jsx("p",{className:"text-gray-600",children:"Loading question..."}),(r==="question"||r==="answered")&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-lg font-semibold mb-3 text-gray-700",children:"What does this chord symbol represent?"}),e.jsx("div",{className:"my-4 p-4 bg-blue-100 border border-blue-300 rounded text-center",children:e.jsxs("span",{className:"text-3xl md:text-4xl font-mono font-bold text-blue-800",children:["C",a.symbolToShow||""]})})]}),r==="question"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-md mb-2 text-gray-600",children:"Select the correct name:"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:a.answerOptions.map(t=>e.jsx("button",{onClick:()=>q(t),className:"w-full text-left py-2 px-4 bg-sky-500 text-white rounded hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-sky-300 transition duration-150 ease-in-out shadow",children:t},t))})]})]}),r==="answered"&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg shadow mb-6 text-center",children:[e.jsx("p",{className:`text-xl font-bold mb-3 ${y.includes("Correct")?"text-green-600":"text-red-600"}`,children:y}),e.jsx("button",{onClick:p,className:"py-2 px-5 bg-indigo-600 text-white rounded hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-400 transition duration-150 ease-in-out shadow",children:"Next Question"})]}),r!=="settings"&&e.jsx("div",{className:"text-right text-gray-600",children:e.jsxs("p",{children:["Score: ",v," / ",C]})})]})};export{F as default};
